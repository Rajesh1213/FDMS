
<style>
a {
  text-decoration: none;
}
a:hover {
  text-decoration: underline;;
}
.table td, .table tr { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;}
.user_info_ul{
  list-style: none;
  width: 400px;
  float:left;
}
.rt_user_info_ul{
  list-style: none;
  width: 400px;
  float:left;
}
.user_info_ul li{
  margin: 5px 0px 5px 0px;
}
.rt_user_info_ul li {
  margin: 5px 0px 5px 0px;
}
</style>

<script type="text/javascript">
  jQuery(document).ready(function($) {
    $('a[rel*=facebox]').facebox({
      loadingImage : '../src/loading.gif',
      closeImage   : '../src/closelabel.png'
    })
  }) 
</script>

<div id="content-header">
  <%= image_tag('users-icon.jpeg') %>
  <h1> Rental Details </h1>
  <h3> <%= @rent.tenant_name %> </h3>
  <div id="app-back-button">
    <%= link_to_function image_tag("buttons/back.png",:border => 0), "history.back()" %>
  </div>
</div>

<div id="inner-tab-menu">
  <ul>
    <li><%= link_to "Search Tenant" ,:action => :view_rents %></li>
  </ul>
</div>

<div id="page-yield">
  <% unless flash[:notice].nil? %><p class="flash-msg"><%= flash[:notice] %></p><% end %>
  <br/>
  <div class="box">
  
  <div class="user_info" style="font-size: 14px; margin: 5px; border: 2px solid #ccc; background-color:#e5e5e5;">
    <ul style="list-style:none;" class ="user_info_ul" >
      <li><strong>Tenant Name : </strong> <span style="color: brown"><%= @rent.tenant_name %> </span></li> 
      <li><strong>Address: </strong> <%=@rent.permanent_address %> </li>
      <li><strong>Mobile: </strong> <%=@rent.mobile%> </li>
      <li><strong>Rented Property: </strong> <%=@rent.add_property.house_number%> </li>
      <li><strong>Area: </strong> <%=@rent.add_property.area%> </li>
      <li><strong>Street Address: </strong> <%=@rent.add_property.street_address%> </li>
    </ul>
    <ul style="list-style:none;" class ="rt_user_info_ul" >
      <li><strong>Contract Signed Date : </strong> <%= @rent.signed_contract_date.strftime("%d-%m-%Y") %> </li> 
      <li><strong>Contract Reneval Date: </strong> <%=@rent.reneval_contract_date.strftime("%d-%m-%Y") %> </li>
      <li><strong>Advance Taken: </strong> Rs. <%=@rent.advance_taken%> </li>
    </ul>
    <div class="clearfix"> </div>
  </div>

<div style="margin: 5px; border-bottom: 1px solid #ccc;"> <strong> --> Rental Full Track Record: </strong> </div>
 <table class ="table table-bordered">

  <tr>
    
    <th>S.No</th>
    <th>Rent Amount</th>
    <th>Due Date</th>
    <th>Paid Date</th>
    <th>Month</th>
    <th>Next Due Date</th>
    <th>Paid Amount</th>
    <th>Bal Amount</th>
    <th>Collected By</th>
    <th> </th>
  </tr>

<%i = 0 %>

<% unknown = "Unknown" %>
<% @rent_details.each do |rent| %>
  <tr>
    <% unless rent.bal_amount == "0" %> <td style ="background-color: orange; "> <% else %> <td style="background-color:green; color: #fff;"> <% end %>
     <strong> <%= i = i.next %> </strong> </td>
    <td>Rs. <%= rent.rent_amount %></td>
    <td><%= rent.due_date.strftime("%d-%m-%Y")%></td>
    <td><%= rent.paid_date.strftime("%d-%m-%Y") unless rent.paid_date.nil?  %></td>
    <td><%= rent.due_date.strftime("%B") %></td>
    <td><%= rent.next_due_date.strftime("%d-%m-%Y") %></td>
    <td><%= rent.paid_amount %></td>
    <td>Rs. <%= rent.bal_amount %></td>
    <% unless rent.collected_by.nil? or rent.collected_by.blank? %>
      <td><%= rent.collected_by %></td>
    <% else %>
      <td>-</td>
    <% end %>
    <td>
    <% unless rent.bal_amount == "0" %>
      <%= link_to_remote "Make Payment",:url => { :action => "make_payment", :id => rent.id }, :method => "get" %>
    <% else %>
      -
    <% end %>
    </td>
  </tr>
  <% if i == 12 %>
    <% i = 0 %>
  <% end %>
<% end %>
<tr style = "background-color: #ccc;" >
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td><strong> Total Rent:  </strong> </td>
<td><strong> Rs. <%= @rent_details.map(&:rent_amount).inject{|sum,x| sum.to_i + x.to_i} %> </strong> </td>   
<td> </td> 
</tr>
<tr style = "background-color: #ccc;" >
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td><strong> Total paid:  </strong> </td>
<td><strong> Rs. <%= @rent_details.map(&:paid_amount).inject{|sum,x| sum.to_i + x.to_i} %> </strong> </td>
<td> </td> 
</tr>
</table>
<div class="extend_contract" style="align: center;"> -->  <%= link_to "Extend Contract Period", :controller => "rents", :action => "extend_rent_contract", :id => @rent.id %> <br/><br/> --> <%= link_to "PDF Report" %> </div>
<div id="modal-box" style="display:none;"></div>
</div>
</div>